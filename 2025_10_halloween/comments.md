I finally managed to do a part C with 3C !! I solved it more or less manually for some test cases. And retro-engineered it to find a heuristic and have a solution that runs in less than a sec.

